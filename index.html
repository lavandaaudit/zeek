<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>IBONIRIUM ¬∑ Terrarium ¬∑ EXP‚Äë03 ¬∑ –ü–æ–ª—è –ö—É–ª—å—Ç—É—Ä ¬∑ –ü–∞–≤—É—Ç–∏–Ω–Ω—è</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
html, body {
  width:100%; height:100%;
  background:#000;
  overflow:hidden;
}
canvas { position:fixed; inset:0; }
#sensors{ position:fixed; left:0; right:0; bottom:0; height:140px; pointer-events:none; }
#info {
  position:fixed;
  bottom:12px; left:12px;
  font-family:monospace;
  color:#88ffcc;
  font-size:12px;
  line-height:1.4;
  opacity:0.85;
}
#panel {
  position:fixed;
  bottom:12px; right:12px;
  max-width:360px;
  font-family:monospace;
  font-size:12px;
  color:#c7ffd9;
  line-height:1.45;
  background:linear-gradient(to left,rgba(0,0,0,0.65),transparent);
  padding:10px 14px;
}
</style>
</head>
<body>
<canvas id="stars"></canvas>
<canvas id="terrarium"></canvas>
<canvas id="sensors"></canvas>
<div id="info">
<b>IBONIRIUM ¬∑ LAB TERRARIUM ¬∑ EXP‚Äë03</b><br>
Phase: <span id="phase">Growth</span><br>
Day: <span id="day">‚Äì</span><br>
Solar SSN: <span id="ssn">‚Äì</span><br>
Solar Factor: <span id="sf">‚Äì</span><br>
Activity: <span id="ge">‚Äì</span><br>
Target: 13 December
</div>
<div id="panel">
<b>–°–¢–ê–ù –ï–ö–°–ü–ï–†–ò–ú–ï–ù–¢–£</b><br>
–ü–æ–ª—è –∫—É–ª—å—Ç—É—Ä –∑ –ø–∞–≤—É—Ç–∏–Ω–Ω—è–º. –ö–æ–∂–Ω–µ –ø–æ–ª–µ ‚Äî —Å–≤—ñ–π –∫–æ–ª—ñ—Ä, —Ö–∞–æ—Ç–∏—á–Ω–∞ —Ñ–æ—Ä–º–∞. –ó–≤‚Äô—è–∑–∫–∏ –º—ñ–∂ –ø–æ–ª—è–º–∏ ‚Äî —Ç–æ–Ω–∫—ñ –ª—ñ–Ω—ñ—ó, —â–æ —Ä–µ–∞–≥—É—é—Ç—å –Ω–∞ —Ä—É—Ö.<br><br>

–î–æ <b>13 –≥—Ä—É–¥–Ω—è</b> ‚Äî —Ñ–∞–∑–∞ —Ä–æ—Å—Ç—É. –ü–æ—Ç—ñ–º —Ñ—ñ–∫—Å–∞—Ü—ñ—è.
</div>
<script>
const starCanvas = document.getElementById('stars');
const tCanvas = document.getElementById('terrarium');
const sensorCanvas = document.getElementById('sensors');
const sctx = starCanvas.getContext('2d');
const tctx = tCanvas.getContext('2d');
const scx = sensorCanvas.getContext('2d');

function resize(){
  starCanvas.width = tCanvas.width = sensorCanvas.width = innerWidth;
  starCanvas.height = tCanvas.height = innerHeight;
  sensorCanvas.height = 140;
}
addEventListener('resize', resize); resize();

/* –ó—ñ—Ä–∫–∏ */
const stars = Array.from({length:300},()=>({x:Math.random(),y:Math.random(),z:Math.random()*0.8+0.2}));
function drawStars(){
  sctx.clearRect(0,0,starCanvas.width,starCanvas.height);
  stars.forEach(st=>{
    st.y += 0.00008 * st.z;
    if(st.y>1) st.y=0;
    sctx.globalAlpha = 0.25 + st.z*0.4;
    sctx.fillStyle="#ddd";
    sctx.beginPath();
    sctx.arc(st.x*starCanvas.width, st.y*starCanvas.height, st.z*1.1, 0, Math.PI*2);
    sctx.fill();
  });
  sctx.globalAlpha=1;
}

/* NOAA */
let solarFactor = 1;
let solarSSN = 0;
let activity = 0;
async function updateSolar(){
  try{
    const r = await fetch('https://services.swpc.noaa.gov/json/solar-cycle/predicted-solar-cycle.json');
    const d = await r.json();
    const l = d[d.length-1];
    solarSSN = l.predicted_ssn;
    solarFactor = Math.min(4, 0.7 + solarSSN/100);
    activity = solarFactor * (0.6 + Math.random()*0.4);
   
    document.getElementById('ssn').textContent = solarSSN.toFixed(1);
    document.getElementById('sf').textContent = solarFactor.toFixed(2);
    document.getElementById('ge').textContent = activity.toFixed(2);
  }catch(e){
    solarFactor = 1.2;
  }
}
updateSolar(); setInterval(updateSolar, 1800000);

/* –ü–û–õ–Ø */
const CULTURES = [
  {name:'–ü—à–µ–Ω–∏—Ü—è', color:'rgba(255,200,80,0.55)'},
  {name:'–Ø—á–º—ñ–Ω—å', color:'rgba(180,220,100,0.55)'},
  {name:'–ö—É–∫—É—Ä—É–¥–∑–∞', color:'rgba(255,230,150,0.55)'},
  {name:'–†–∏—Å', color:'rgba(150,200,255,0.55)'},
  {name:'–°–æ—è', color:'rgba(180,150,255,0.55)'},
  {name:'–û–≤–µ—Å', color:'rgba(200,180,255,0.55)'},
  {name:'–ì—Ä–µ—á–∫–∞', color:'rgba(255,150,180,0.55)'}
];

class Field {
  constructor(x,y){
    this.cx=x;
    this.cy=y;
    this.growth=0;
    this.maxGrowth=20 + Math.random()*15; // –±—ñ–ª—å—à–∏–π —Ä–∞–¥—ñ—É—Å
    this.offset=Math.random();
    this.dir=Math.random()<0.5?1:-1;
    this.speed=0.0003 + Math.random()*0.0005;
    this.culture = CULTURES[Math.floor(Math.random()*CULTURES.length)];
    this.fieldSize = 3 + solarFactor*2;
  }
  grow(){
    if(this.growth<this.maxGrowth) this.growth += 0.035*solarFactor;
    this.speed = (0.0003 + Math.random()*0.0005) * solarFactor * 1.3;
    this.offset += this.dir*this.speed;
    if(this.offset>1) this.offset-=1;
    if(this.offset<0) this.offset+=1;
    this.fieldSize = 3 + solarFactor*2;
  }
  draw(){
    const breath = 1 + Math.sin(Date.now()*0.0008 + this.offset*Math.PI)*0.03;
    const steps = Math.min(this.growth,this.maxGrowth)*35; // –±—ñ–ª—å—à–µ –≤–∏—Ç–∫—ñ–≤
    tctx.strokeStyle=this.culture.color;
    tctx.lineWidth=0.7;
    tctx.beginPath();
    for(let i=0;i<=steps;i++){
      const t = i/steps;
      const chaos = (Math.random()-0.5)*5*activity; // —Ö–∞–æ—Ç–∏—á–Ω–∞ —Ñ–æ—Ä–º–∞
      const radius = t*70*breath*(1 + activity*0.4) + chaos; // –±—ñ–ª—å—à–∏–π —Ä–∞–¥—ñ—É—Å
      const angle = t*Math.PI*2*(0.25*15 + Math.sin(i*0.3+this.offset*5)); // —Ö–∞–æ—Ç–∏—á–Ω–∏–π –ø–æ–≤–æ—Ä–æ—Ç
      const x = this.cx + Math.cos(angle)*radius;
      const y = this.cy + Math.sin(angle)*radius;
      if(i===0) tctx.moveTo(x,y);
      else tctx.lineTo(x,y);
    }
    tctx.stroke();

    // –¶–µ–Ω—Ç—Ä –ø–æ–ª—è
    const markerR = this.offset*70*0.92*breath;
    const markerA = this.offset*Math.PI*2*12;
    const px = this.cx + Math.cos(markerA)*markerR;
    const py = this.cy + Math.sin(markerA)*markerR;
    const tremor = Math.sin(Date.now()*0.012 + this.cx)*0.4;
    tctx.fillStyle="rgba(30,20,50,0.9)";
    tctx.beginPath();
    tctx.arc(px + tremor, py, this.fieldSize, 0, Math.PI*2);
    tctx.fill();
  }
}

// –ú–∞—Å–∏–≤ –ø–æ–ª—ñ–≤
const fields = Array.from({length:22},()=>new Field(
  Math.random()*tCanvas.width,
  Math.random()*tCanvas.height*0.85 + tCanvas.height*0.1
));

// –ó–≤'—è–∑–∫–∏ –º—ñ–∂ –ø–æ–ª—è–º–∏
function drawLinks(){
  tctx.strokeStyle='rgba(180,180,255,0.12)';
  tctx.lineWidth=0.5;
  for(let i=0;i<fields.length;i++){
    for(let j=i+1;j<fields.length;j++){
      const f1=fields[i], f2=fields[j];
      const dx=f2.cx-f1.cx;
      const dy=f2.cy-f1.cy;
      const dist=Math.sqrt(dx*dx+dy*dy);
      if(dist<400){ // —Ç—ñ–ª—å–∫–∏ –±–ª–∏–∂–Ω—ñ
        const chaos = (Math.random()-0.5)*6*activity;
        tctx.beginPath();
        tctx.moveTo(f1.cx + chaos, f1.cy + chaos);
        tctx.lineTo(f2.cx + chaos, f2.cy + chaos);
        tctx.stroke();
      }
    }
  }
}

/* SENSORS */
function drawSensors(){
  scx.clearRect(0,0,sensorCanvas.width,sensorCanvas.height);
  const baseY = 110;
  scx.strokeStyle='rgba(120,255,180,0.15)';
  scx.beginPath(); scx.moveTo(0,baseY); scx.lineTo(sensorCanvas.width,baseY); scx.stroke();

  scx.fillStyle='rgba(255,220,140,0.75)';
  scx.beginPath();
  scx.arc(80, baseY-40, 9 + solarFactor*4.5, 0, Math.PI*2);
  scx.fill();
  scx.fillStyle="#fff"; scx.font="11px monospace";
  scx.fillText('‚òÄ SSN', 55, baseY+20);

  scx.strokeStyle='rgba(160,220,255,0.75)';
  scx.beginPath();
  scx.moveTo(160, baseY);
  scx.lineTo(160, baseY - activity*32);
  scx.stroke();
  scx.fillText('üß¨ —Ä—ñ—Å—Ç', 130, baseY+20);

  const now = new Date();
  const t = Math.min(1,(now-START_DATE)/(STOP_DATE-START_DATE));
  scx.strokeStyle='rgba(200,200,255,0.6)';
  scx.beginPath();
  scx.arc(260, baseY, 30, -Math.PI/2, -Math.PI/2 + t*Math.PI*2);
  scx.stroke();
  scx.fillText('‚è≥', 245, baseY+20);
}

/* LOOP */
const START_DATE = new Date('2026-01-01');
const STOP_DATE = new Date('2026-12-13');
function updateDay(){
  const now = new Date();
  const day = Math.floor((now - START_DATE)/86400000);
  document.getElementById('day').textContent = day>=0?day:'‚Äì';
  document.getElementById('phase').textContent = now<STOP_DATE?'Growth':'Final';
}
setInterval(updateDay,60000);
updateDay();

function loop(){
  drawStars();
  drawSensors();
  if(new Date()<STOP_DATE){
    tctx.clearRect(0,0,tCanvas.width,tCanvas.height);
    fields.forEach(f=>{ f.grow(); f.draw(); });
    drawLinks();
  }
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
